# 日志、配置与中间件模式

## 日志
- 标准库：`log` / Go1.21+ `log/slog`
- 三方：`zap`（性能优先）、`zerolog`（零分配）
- 结构化字段示例：`log/slog.Info("login", "user", id, "ip", ip)`

## 配置
- 环境变量优先：`os.LookupEnv`
- `flag` 解析 CLI 参数
- 可选三方：`spf13/viper`（需网络）

## HTTP 中间件模式（net/http）
```go
type Middleware func(http.Handler) http.Handler

func Chain(h http.Handler, m ...Middleware) http.Handler {
    for i := len(m)-1; i >=0; i-- {
        h = m[i](h)
    }
    return h
}
```

## 练习
- 为 mini TODO API 添加请求日志中间件
- 封装配置加载：优先 CLI，其次环境变量，最后默认值
